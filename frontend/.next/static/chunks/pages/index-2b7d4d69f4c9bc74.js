(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2936:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(3122)}])},3122:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var s=a(7876),l=a(4232),r=a(7328),n=a.n(r),o=a(8230),i=a.n(o);function c(e){let{onUpload:t,loading:a}=e,[r,n]=(0,l.useState)(!1),[o,i]=(0,l.useState)(null),[c,d]=(0,l.useState)(null),m=(0,l.useRef)(null),u=e=>{if(e&&e.type.startsWith("image/")){d(e);let t=new FileReader;t.onload=e=>i(e.target.result),t.readAsDataURL(e)}else alert("Please select a valid image file")},x=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?n(!0):"dragleave"===e.type&&n(!1)};return(0,s.jsx)("form",{className:"w-full",onSubmit:e=>{e.preventDefault(),c&&t(c)},onDragEnter:x,children:(0,s.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center ".concat(r?"border-blue-600 bg-blue-50":"border-gray-300"),onDragEnter:x,onDragLeave:x,onDragOver:x,onDrop:e=>{e.preventDefault(),e.stopPropagation(),n(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&u(e.dataTransfer.files[0])},children:[(0,s.jsx)("input",{ref:m,type:"file",accept:"image/*",onChange:e=>{e.target.files&&e.target.files[0]&&u(e.target.files[0])},className:"hidden"}),o?(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("img",{src:o,alt:"Preview",className:"max-h-64 mx-auto rounded"})}):(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Drag and drop an image, or click to select"})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>{m.current.click()},className:"px-4 py-2 bg-gray-200 rounded hover:bg-gray-300 transition",children:"Select Image"}),(0,s.jsx)("button",{type:"submit",disabled:!c||a,className:"px-4 py-2 rounded transition ".concat(!c||a?"bg-gray-300 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:a?"Processing...":"Detect People"})]})]})})}function d(e){let{result:t}=e;return t?(0,s.jsxs)("div",{className:"mt-8 bg-white shadow-md rounded-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"p-4 border-b",children:(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Detection Results"})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("p",{className:"text-lg font-semibold",children:["Number of people detected: ",(0,s.jsx)("span",{className:"text-blue-600",children:t.people_count})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["File: ",t.original_filename]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Processed on: ",new Date(t.timestamp).toLocaleString()]})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Visualized Result"}),(0,s.jsx)("div",{className:"border rounded p-1",children:(0,s.jsx)("img",{src:"".concat("http://localhost:8386/api/v1/detect").concat(t.result_image_url),alt:"Detection Result",className:"w-full h-auto rounded"})})]})]})]}):null}function m(){let[e,t]=(0,l.useState)(null),[a,r]=(0,l.useState)(!1),[o,m]=(0,l.useState)(null),u="http://localhost:8386/api/v1/detect",x=async e=>{r(!0),m(null),t(null);try{let a=new FormData;a.append("file",e),console.log("Uploading to API:",u);let s=await fetch(u,{method:"POST",body:a});if(!s.ok)throw Error("Server Error: ".concat(s.status," - ").concat(await s.text()));let l=await s.json();if(null==l?void 0:l.image_path){let e=l.image_path.split("/").pop();l.image_path="/api/images/".concat(e)}t(l)}catch(e){console.error("Upload failed:",e),m(e.message||"An unexpected error occurred.")}finally{r(!1)}};return(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)(n(),{children:[(0,s.jsx)("title",{children:"Person Detection System"}),(0,s.jsx)("meta",{name:"description",content:"Upload images to detect people"})]}),(0,s.jsxs)("header",{className:"mb-12 text-center",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold mb-4",children:"Person Detection System"}),(0,s.jsx)("p",{className:"text-lg text-gray-600",children:"Upload an image to detect and count people"})]}),(0,s.jsx)("main",{className:"flex flex-col items-center",children:(0,s.jsxs)("div",{className:"w-full max-w-2xl",children:[(0,s.jsx)(c,{onUpload:x,loading:a}),o&&(0,s.jsxs)("div",{className:"mt-6 p-4 bg-red-100 text-red-700 border border-red-400 rounded-md",children:["âŒ ",o]}),e&&(0,s.jsx)(d,{result:e})]})}),(0,s.jsx)("footer",{className:"mt-12 text-center",children:(0,s.jsx)(i(),{href:"/history",className:"text-blue-600 hover:text-blue-800 text-lg font-medium",children:"View Detection History"})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[695,636,593,792],()=>t(2936)),_N_E=e.O()}]);